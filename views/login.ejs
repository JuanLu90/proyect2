<% include _header %>
<style>
  .form {
    margin: auto;
  }
</style>
<main>
  <h1 class="text-center text-light mt-5">Login</h1>
  <div class="bg-dark text-light p-3 form w-25 mt-5">
    <div class="form-group">
      <label for="">User</label>
      <input
        type="text"
        name="username"
        id="username"
        class="form-control bg-warning"
        placeholder="User"
      />
    </div>
    <div class="form-group">
      <label for="">Password</label>
      <input
        type="password"
        name="password"
        id="password"
        class="form-control bg-warning"
        placeholder="Password"
      />
    </div>
    <div class="text-center">
      <input
        type="button"
        class="btn btn-primary w-25"
        value="Enviar"
        onclick="getToken()"
      />
    </div>
  </div>
</main>

<script>
  function getToken() {
    const usernameValue = document.getElementById("username").value;
    const passwordValue = document.getElementById("password").value;
    fetch("api/auth", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ username: usernameValue, password: passwordValue })
    }).then(response => {
      if (response.ok) {
        response.text().then(text => {
          sessionStorage.setItem("token", text);
          location.href = "/users";
        });
      }
    });
  }
</script>
<% include _footer %>
